#!/bin/bash


hosts=("172.20.53.204" "172.20.53.205" "172.20.53.206" "172.20.53.207" "172.20.53.208" "172.20.53.209" "172.20.53.210" "172.20.53.211"  "172.20.53.212" "172.20.53.213" "172.20.53.214" "172.20.53.215" "172.20.53.216" "172.20.53.217" "172.20.53.218" "172.20.53.219" "172.20.53.220" "172.20.53.221" "172.20.53.222" "172.20.53.223" "172.20.53.224" "172.20.53.225" "172.20.53.226" "172.20.53.227" "172.20.53.228" "172.20.53.229" "172.20.53.230" "172.20.53.231" "172.20.53.232" "172.20.53.233" "172.20.53.234" "172.20.53.235" "172.20.53.236" "172.20.53.237" "172.20.53.238" "172.20.53.239" "172.20.53.240" "172.20.53.241" "172.20.53.242" "172.20.53.243" "172.20.53.244" "172.20.53.245" "172.20.53.246" "172.20.53.247" "172.20.53.248" "172.20.53.249" "172.20.53.250" "172.20.53.251" "172.20.53.252" "172.20.53.253" "172.20.53.254")
# hosts=("172.20.53.211" "172.20.53.212" "172.20.53.213")
 
login="user" # имя пользователя для подключения по SSH
password="User123456" # пароль для подключения по SSH
command="hostname"

for host in ${hosts[@]}; do
    {
        ping -c 1 $host > /dev/null # пингуем компьютер

        if [ $? -eq 0 ]; then # если пинг успешный, то подключаемся по SSH
            commands_result=`sshpass -p $password ssh -o StrictHostKeyChecking=no $login@$host $command` 
            echo "!!! ${commands_result} (IP ${host})"
        	 
        fi
    } &
done

wait
